---
title: "Amazon RDS"
tagline: "Guía práctica para configurar y conectarse a una instancia en RDS"
author: Marco Contreras
tags: [aws, rds, base-de-datos, cloud, devops, mysql, postgresql]
layout: post
---

Amazon Web Services ( AWS ) ofrece una amplia gama de herramientas para crear y administrar aplicaciones en la nube. Unos de los servicios más requeridos para almacenamiento y bases de datos es Amazon Relational Database Service ( RDS ).

## __¿Qué es AWS RDS?__

Amazon RDS ( Relational Database Service ) es un servicio administrado que facilita la creación, configuración, escalado y respaldo de bases de datos SQL como [__MySQL__](https://www.mysql.com/){:target='_blank'}, [__PostgreSQL__](https://www.postgresql.org/){:target='_blank'}, [__Oracle__](https://www.oracle.com/cl/){:target='_blank'} y [__SQL Server__](https://www.microsoft.com/es-es/sql-server/sql-server-downloads){:target='_blank'}.

> AWS RDS es ideal para quienes quieren enfocarse en construir sin preocuparse de parches, disponibilidad o backups.

### Características que ofrece RDS

- **Administración automática**: backups, actualizaciones y parches automáticos.
- **Escalabilidad vertical**: cambia la capacidad sin perder datos
- **Seguridad integrada**: encriptación, VPC, IAM, SSL
- **Alta disponibilidad**: Multi-AZ con failover automático


## __Configuración de una instancia en AWS RDS__

Para empezar a usar RDS y crear una nueva instancia a través de la consola de AWS. Se debe contar con una cuenta:

__Opción 1:__
- Registrate para acceder a tu cuenta en [__https://aws.amazon.com/free/__](https://aws.amazon.com/free/).

__Opción 2:__
- Desde una cuenta de estudiante en el [__portal de AWS Academy__](https://awsacademy.instructure.com/login/canvas) inicia el AWS Learner Lab.

## __Crear una instancia de RDS__

### __Pasos a seguir__

1. En la consola de búsqueda de AWS, busque “RDS”. Haz clic en el servicio Aurora y RDS:

![Search RDS]({{ 'assets/images/aws/search-rds.png' | relative_url }})

{:start="2"}
2. Clic en **Crear base de datos** en el menú:

![Create DB]({{ 'assets/images/aws/create-db-btn.png' | relative_url }})

{:start="3"}
3. Selecciona el motor de base de datos:
   - Motor: **MySQL** o **PostgreSQL**

![MySQl selection]({{ 'assets/images/aws/selection-db-mysql.png' | relative_url }})

{:start="4"}
4. Selecciona una plantilla:
   - Plantillas: 
        - Selecciona __Producción__ si está ejecutando una aplicación y necesita una __alta disponibilidad__.
        - Selecciona __Desarrollo y pruebas__ si esto es para desarrollo interno o experimentación.
        - Selecciona __Entorno de pruebas__ (**Free Tier**) simplemente si son pruebas básicas y así evitar cargos adicionales. 

![Template selection]({{ 'assets/images/aws/selection-template.png' | relative_url }})

{:start="4"}
4. Según la selección anterior, se podrá gestionar la __disponibilidad y durabilidad__:
    - Opciones de implementación:
        - Selecciona un clúster de base de datos __Multi-AZ__ (3 instancias) para cargas de trabajo de alta lectura y máxima resiliencia (dos réplicas legibles).
        - Selecciona la instancia de base de datos __Multi-AZ__ (2 instancias) para la mayoría de las configuraciones de producción, agrega una instancia en espera para conmutación por error sin capacidad de lectura adicional.
        - Seleccione __Single-AZ__ solo para desarrollo/pruebas o aplicaciones no críticas, sin conmutación por error ni redundancia.

![Selection Durability]({{ 'assets/images/aws/selection-disponibility-durability.png' | relative_url }})

{:start="5"}
5. Después de seleccionar lo anterior, configure el resto de opciones como:
   - Nombre para el clúster: `mi-app-db`
   - Usuario: `admin`
   - Contraseña: `*********`

![Config Options DB]({{ 'assets/images/aws/config-db-options.png' | relative_url }})

{:start="6"}
6. En conectividad:
   - Mantenga seleccionada la opción __No se conecte a un recurso informático EC2__ 
   - Asegúrate de seleccionar una VPC con acceso público (solo si quieres acceder desde tu PC)
   - Habilita "Acceso público" solo para pruebas

![Config conevitidad]({{ 'assets/images/aws/config-conectividad.png' | relative_url }})

{:start="7"}
7. Crea la instancia y espera ~10 minutos ⏳

## __Conexión a AWS RDS__

Una vez que su instancia de base de datos esté en funcionamiento, podrá conectarse a ella de varias maneras.

El acceso a las instancias de RDS se controla mediante [__grupos de seguridad__](https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/Overview.RDSSecurityGroups.html).  Por lo tanto, necesitamos crear un nueva regla dentro de un grupo de seguridad que permita el acceso entrante al puerto __3306__ (para MySQL).

### Añadir una nueva regla al grupo de seguridad

Para modificar las reglas del grupo de seguridad asociado a nuestra instancia, necesitamos realizar los siguientes pasos:

- Seleccionar la instancia que queremos configurar
- Ir a la pestaña de __Conectividad y Seguridad__
- Clic sobre el enlace con el nombre del grupo

![Pestaña conectividad]({{ '/assets/images/aws/rds-conectividad-y-seguridad.webp' | relative_url }})

- Esto nos llevará automáticamente al servicio de __Amazon EC2__, donde se administran los grupos de seguridad. Haz clic sobre el ID del grupo.

![AWS EC2 Grupo de Seguridad]({{ 'assets/images/aws/rds-grupo-de-seguridad-ec2.webp' | relative_url }})

- En la siguiente ventana, bajas hasta el apartado de reglas de entrada y presionamos sobre el botón __editar reglas de entrada__.

![Editar reglas de entrada]({{ 'assets/images/aws/grupo-de-seguridad-ec2-editar-reglas.webp' | relative_url }})

- Finalmente, añadimos la nueva regla.

![Añadir la nueva regla]({{ 'assets/images/aws/grupo-de-seguridad-agregar-regla.webp' | relative_url }})

> Evita usar `0.0.0.0/0` a menos que sea estrictamente necesario para pruebas, ya que abre tu RDS a cualquier dirección IP en internet.

### Conexión desde clientes externos

Después de definir la nueva regla, y los cambios se aplican. Puedes ahora probar la conexión desde tu cliente MySQL local o alguna aplicación.

__Desde una CLI__:

```bash
mysql -u admin -h mi-app-db.xxxxxxxxxxx.us-east-1.rds.amazonaws.com -p
```

![Connect from CLI]({{ 'assets/images/aws/conexion-a-rds-mysql-desde-cli.webp' | relative_url }})


__Desde un backend Java con Spring Boot__:

```ini
spring.datasource.url=jdbc:mysql://mi-app-db.xxxxxx.rds.amazonaws.com:3306/miappdb
spring.datasource.username=admin
spring.datasource.password=tu_contraseña
spring.jpa.hibernate.ddl-auto=update
```

Listo: RDS se comporta como cualquier MySQL tradicional, pero gestionado por AWS ✅.